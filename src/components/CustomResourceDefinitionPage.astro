---
import { PropertyTree } from "./PropertyTree";
import { PropertyType } from "./PropertyType";
import { IconBulb } from "@tabler/icons-react";
import ChangeHistory from "./ChangeHistory.astro";
import type { Project } from "@lib/crds";
import type { Resource } from "@lib/kube";

type Props = {
  project: Project;
  resource: Resource;
  tag: string;
};

const { project, resource, tag } = Astro.props;
const apiVersion = `${resource.gvk.group}/${resource.gvk.version}`;
---

<nav class="order-first flex space-x-2 pb-10 text-sm font-semibold">
  <a
    class="text-muted-foreground hover:underline"
    href={!tag || tag === project.versions[0] ? "/" : `/${tag}`}
  >
    ‚Üê back to all kinds
  </a>
</nav>

<div class="flex flex-col pb-4">
  <h2 class="text-base font-semibold text-primary">
    {apiVersion} &middot; {resource.scope} Resource
  </h2>
  <h1 class="mt-2 text-3xl font-bold leading-8 tracking-tight sm:text-4xl">
    {resource.gvk.kind}
  </h1>
  <pre
    class="mt-2 max-w-4xl whitespace-pre-line text-lg text-muted-foreground">
        {resource.definition.description || <span class="italic">No Description</span>}
</pre>

  <PropertyTree definition={resource.definition} level={0} client:load />

  <div
    class="inline-flex items-center gap-1 p-2 border rounded text-muted-foreground font-medium text-sm mt-4"
  >
    <IconBulb className="size-4" />
    <p>
      Click on <span class="font-mono font-bold text-foreground"
        >Property Name</span
      > to see the description, and <PropertyType
        type="Pink Types"
        hasChildren
        className="font-semibold tracking-normal"
      /> to expand schema.
    </p>
  </div>

  <ChangeHistory version={tag} gvk={resource.gvk} />
  <!-- <ExampleList apiVersion={apiVersion} kind={resource.gvk.kind} /> -->
  <!-- <ResourceLinks links={metadata.links} kind={resource.gvk.kind} /> -->
</div>
